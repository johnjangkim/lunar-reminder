<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar & Lunar Calendar</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <div class="nav-controls">
                <button id="prevBtn" class="nav-btn">&lt;</button>
                <button id="todayBtn" class="today-btn">Today</button>
                <button id="nextBtn" class="nav-btn">&gt;</button>
            </div>
            <h1 id="monthYearDisplay"></h1>
            <button id="addReminderBtn" class="add-btn">+</button>
        </header>

        <div class="calendar-grid" id="calendarGrid">
            <div class="weekday">Sun</div>
            <div class="weekday">Mon</div>
            <div class="weekday">Tue</div>
            <div class="weekday">Wed</div>
            <div class="weekday">Thu</div>
            <div class="weekday">Fri</div>
            <div class="weekday">Sat</div>
            <!-- Days will be injected here by JS -->
        </div>

        <!-- Database Tools Area -->
        <div
            style="margin: 2rem 0; padding: 1.5rem; background: rgba(255,255,255,0.7); backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.3); text-align: center;">
            <h3 style="margin-bottom: 1rem; color: #1e3a8a;">Database Tools</h3>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <button id="migrateDataBtn" class="btn secondary">Migrate Old Local Data</button>
                <button id="seedHolidaysBtn" class="btn secondary">Register Default Holidays (2024-2030)</button>
                <button id="exportBtn" class="btn secondary">Export Backup (JSON)</button>
                <button id="importBtn" class="btn secondary">Import Backup (JSON)</button>
                <input type="file" id="importFile" style="display: none;" accept=".json">
            </div>
            <p style="font-size: 0.8em; color: #6b7280; margin-top: 1rem;">* Use these tools if your old schedules
                are missing or you want holidays to appear as registered events.</p>
        </div>

        <div class="conversion-divider"></div>

        <div class="conversion-section">
            <h2>Lunar to Solar Converter</h2>
            <div class="conversion-form">
                <div class="form-group">
                    <label for="lunarYear">Year</label>
                    <input type="number" id="lunarYear" placeholder="YYYY" min="1900" max="2100">
                </div>
                <div class="form-group">
                    <label for="lunarMonth">Month</label>
                    <input type="number" id="lunarMonth" placeholder="MM" min="1" max="12">
                </div>
                <div class="form-group">
                    <label for="lunarDay">Day</label>
                    <input type="number" id="lunarDay" placeholder="DD" min="1" max="30">
                </div>
                <div class="form-group checkbox-group">
                    <label for="isLeap">Leap Month</label>
                    <input type="checkbox" id="isLeap">
                </div>
                <button id="convertBtn">Convert</button>
            </div>
            <div id="conversionResult" class="result-display"></div>
        </div>
    </div>

    <!-- Reminder Modal -->
    <div id="reminderModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="remModalTitle">Manage Reminder</h2>
            <form id="reminderForm">
                <input type="hidden" id="remId">
                <div class="form-group">
                    <label for="remTitle">Title</label>
                    <input type="text" id="remTitle" required placeholder="Event Name">
                </div>
                <div class="form-group">
                    <label>Date Type</label>
                    <div class="radio-group">
                        <label><input type="radio" name="remType" value="SOLAR" checked> Solar</label>
                        <label><input type="radio" name="remType" value="LUNAR"> Lunar</label>
                    </div>
                </div>
                <div class="form-group row">
                    <div>
                        <label for="remYear">Year</label>
                        <input type="number" id="remYear" placeholder="YYYY" value="2024">
                    </div>
                    <div>
                        <label for="remMonth">Month</label>
                        <input type="number" id="remMonth" placeholder="MM" min="1" max="12" required>
                    </div>
                    <div>
                        <label for="remDay">Day</label>
                        <input type="number" id="remDay" placeholder="DD" min="1" max="31" required>
                    </div>
                </div>
                <div class="form-group row">
                    <div style="flex:1">
                        <label for="remTime">Time</label>
                        <input type="time" id="remTime">
                    </div>
                    <div style="flex:1">
                        <label for="remAlert">Alert</label>
                        <select id="remAlert"
                            style="width:100%; padding:0.5rem; border:1px solid #ccc; border-radius:4px;">
                            <option value="none">None</option>
                            <option value="at_time">At time of event</option>
                            <option value="1h_before">1 hour before</option>
                            <option value="1d_before">1 day before</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="remRecurrence">Recurrence</label>
                    <select id="remRecurrence"
                        style="width:100%; padding:0.5rem; border:1px solid #ccc; border-radius:4px;">
                        <option value="NONE">No Repeat</option>
                        <option value="WEEKLY">Weekly</option>
                        <option value="MONTHLY">Monthly</option>
                        <option value="ANNUALLY">Annually</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">Save</button>
                    <button type="button" class="secondary-btn" id="cancelRemBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Day Details Modal (View/Delete Events) -->
    <div id="dayModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeDayModal">&times;</span>
            <h2 id="dayModalDate"></h2>
            <div id="eventList" class="event-list">
                <!-- Events will be populated here -->
            </div>
            <div class="form-actions" style="justify-content: center; margin-top: 1rem; gap: 1rem;">
                <button type="button" class="primary-btn" id="addEventFromDayBtn">Add Event</button>
                <button type="button" class="secondary-btn" id="closeDayBtn">Close</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
    <!-- Custom Alert Modal -->
    <div id="alertModal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <div style="margin-bottom: 1.5rem;">
                <h3 id="alertTitle" style="margin: 0; color: var(--accent); font-size: 1.5rem;">Reminder</h3>
                <p id="alertMessage" style="color: var(--text-secondary); margin-top: 0.5rem; font-size: 1.1rem;"></p>
            </div>
            <button id="closeAlertBtn" class="primary-btn" style="width: 100%;">Acknowledge</button>
        </div>
    </div>


    <!-- Delete Choice Modal -->
    <div id="deleteChoiceModal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h3 style="margin-bottom: 1.5rem; color: #ef4444;">Delete Reminder</h3>
            <p style="margin-bottom: 2rem; color: var(--text-secondary);">How would you like to delete this event?</p>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <button id="deleteSingleBtn" class="primary-btn" style="background-color: #ef4444;">This Instance
                    Only</button>
                <button id="deleteSeriesBtn" class="primary-btn" style="background-color: #dc2626;">All of This Series
                    (Same Title)</button>
                <button id="cancelDeleteBtn" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>


    <script src="script.js"></script>
</body>

</html>